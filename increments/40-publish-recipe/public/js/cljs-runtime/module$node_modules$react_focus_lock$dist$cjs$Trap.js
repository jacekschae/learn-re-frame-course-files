shadow$provide.module$node_modules$react_focus_lock$dist$cjs$Trap=function(global,process,require,module,exports,shadow$shims){function autoGuard(startIndex,end,step,allNodes){var lastGuard=null,i=startIndex;do{var item=allNodes[i];if(item.guard)item.node.dataset.focusAutoGuard&&(lastGuard=item);else if(item.lockItem){if(i!==startIndex)return;lastGuard=null}else break}while((i+=step)!==end);lastGuard&&(lastGuard.node.tabIndex=0)}global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard");
process=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports.default=exports.onFocus=exports.onBlur=void 0;var _toConsumableArray2=process(require("module$node_modules$$babel$runtime$helpers$toConsumableArray"));process(require("module$node_modules$react$index"));process(require("module$node_modules$prop_types$index"));process=process(require("module$node_modules$react_clientside_effect$lib$index"));var _focusLock=
global(require("module$node_modules$focus_lock$dist$cjs$index")),_util=require("module$node_modules$react_focus_lock$dist$cjs$util"),lastActiveTrap=null,lastActiveFocus=null,lastPortaledElement=null,defaultWhitelist=function(){return!0},extractRef=function(ref){return ref&&"current"in ref?ref.current:ref},activateTrap=function(){var result=!1;if(lastActiveTrap){var _lastActiveTrap=lastActiveTrap,persistentFocus=_lastActiveTrap.persistentFocus,autoFocus=_lastActiveTrap.autoFocus,shards=_lastActiveTrap.shards;
_lastActiveTrap=_lastActiveTrap.observed||lastPortaledElement&&lastPortaledElement.portaledElement;var activeElement=document&&document.activeElement;if(_lastActiveTrap){shards=[_lastActiveTrap].concat((0,_toConsumableArray2.default)(shards.map(extractRef).filter(Boolean)));if(!activeElement||(lastActiveTrap.whiteList||defaultWhitelist)(activeElement))if(persistentFocus||!(document&&document.activeElement===document.body||(0,_focusLock.focusIsHidden)())||!lastActiveFocus&&autoFocus)!_lastActiveTrap||
(0,_focusLock.focusInside)(shards)||lastPortaledElement&&lastPortaledElement.portaledElement===activeElement||(document&&!lastActiveFocus&&activeElement&&!autoFocus?(activeElement.blur(),document.body.focus()):(result=(0,_focusLock.default)(shards,lastActiveFocus),lastPortaledElement={})),lastActiveFocus=document&&document.activeElement;if(document){var newActiveElement=document&&document.activeElement;persistentFocus=(0,_focusLock.getFocusabledIn)(shards);if(autoFocus=persistentFocus.find(function(_ref){return _ref.node===
newActiveElement}))persistentFocus.filter(function(_ref2){var node=_ref2.node;return _ref2.guard&&node.dataset.focusAutoGuard}).forEach(function(_ref3){return _ref3.node.removeAttribute("tabIndex")}),autoFocus=persistentFocus.indexOf(autoFocus),autoGuard(autoFocus,persistentFocus.length,1,persistentFocus),autoGuard(autoFocus,-1,-1,persistentFocus)}}}return result},onTrap=function(event){activateTrap()&&event&&(event.stopPropagation(),event.preventDefault())},onBlur=function(){return(0,_util.deferAction)(activateTrap)};
exports.onBlur=onBlur;exports.onFocus=function(event){var source=event.target;event=event.currentTarget;event.contains(source)||(lastPortaledElement={observerNode:event,portaledElement:source})};require=(0,process.default)(function(propsList){return propsList.filter(function(_ref5){return!_ref5.disabled}).slice(-1)[0]},function(trap){trap&&!lastActiveTrap&&(document.addEventListener("focusin",onTrap,!0),document.addEventListener("focusout",onBlur));var lastTrap=lastActiveTrap,sameTrap=lastTrap&&trap&&
trap.onActivation===lastTrap.onActivation;lastActiveTrap=trap;if(lastTrap&&!sameTrap)lastTrap.onDeactivation();if(trap){lastActiveFocus=null;if(!sameTrap||lastTrap.observed!==trap.observed)trap.onActivation();activateTrap(!0);(0,_util.deferAction)(activateTrap)}else document.removeEventListener("focusin",onTrap,!0),document.removeEventListener("focusout",onBlur),lastActiveFocus=null})(function(){return null});exports.default=require}
//# sourceMappingURL=module$node_modules$react_focus_lock$dist$cjs$Trap.js.map
